<div class="container">
    <div class="row justify-content-center">
        <div class="col-12 text-center">
            <img src="assets/logo.jpeg" alt="Logo" class="form-logo">
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-12 col-md-8">
            <form [formGroup]="memberForm" (ngSubmit)="onSubmit()">
                <h3 class="text-center">Member Registration Form</h3>
                <div class="section form-container text-start">
                    <div class="form-row">
                        <label class="form-label" for="gender">Please select:</label>
                        <select class="form-control" formControlName="gender" id="gender">
                            <option value="MALE">Male</option>
                            <option value="FEMALE">Female</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label class="form-label" for="firstName">First Name:</label>
                        <input id="firstName" class="form-control" formControlName="firstName" placeholder="First Name">
                    </div>
                    <div class="form-row">
                        <label class="form-label" for="lastName">Last Name:</label>
                        <input id="lastName" class="form-control" formControlName="lastName" placeholder="Last Name">
                    </div>
                    <div class="form-row">
                        <label class="form-label" for="phone">Phone:</label>
                        <input id="phone" class="form-control" formControlName="phone" placeholder="Phone">
                    </div>
                    <div class="form-row">
                        <label class="form-label" for="email">Email:</label>
                        <input id="email" class="form-control" formControlName="email" placeholder="Email">
                    </div>
                </div>


                <div class="section form-container text-start">
                    <!-- Hebrew name and parents -->
                    <div class="form-row">
                        <label class="form-label" for="hebrewName">Hebrew Name:</label>
                        <input id="hebrewName" class="form-control" formControlName="hebrewName"
                            placeholder="Hebrew Name">
                    </div>
                    <div class="form-row">
                        <label class="form-label" for="fatherName">Father's name:</label>
                        <input id="fatherName" class="form-control" formControlName="fatherName"
                            placeholder="Father's Name">
                    </div>
                    <div class="form-row">
                        <label class="form-label" for="motherName">Mother's name:</label>
                        <input id="motherName" class="form-control" formControlName="motherName"
                            placeholder="Mother's Name">
                    </div>
                </div>

                <div class="section form-container text-start">
                    <div formGroupName="dob" class="form-row baseline hdate-row">
                        <label class="form-label small-label">Date of birth:</label>
                        <app-hdate (dateChange)="onDobDateChange($event)" [day]="memberForm.get('dob.day')?.value"
                            [month]="memberForm.get('dob.month')?.value"
                            [engDate]="memberForm.get('dob.engDate')?.value">
                        </app-hdate>
                    </div>

                    @if (memberForm.get('gender')?.value == 'MALE') {
                    <div class="form-row">
                        <label class="form-label small-label" for="bmParasha">Bar Mitzva Parasha:</label>
                        <app-bm-select [selected]="memberForm.get('bmParasha')?.value"
                            (parashaSelected)="onParashaSelected($event)"></app-bm-select>
                    </div>
                    }

                    <div formGroupName="anniversary" class="form-row baseline hdate-row">
                        <label class="form-label small-label">Anniversary: (If applicable)</label>
                        <app-hdate (dateChange)="onAnniversaryDateChange($event)" [day]="anniversaryDayValue"
                            [month]="anniversaryMonthValue" [engDate]="anniversaryEngDateValue">
                        </app-hdate>
                    </div>

                    <div class="form-row">
                        <label class="form-label" for="spouse">Spouse:</label>
                        <input id="spouse" class="form-control" formControlName="spouse" placeholder="Spouse's name">
                    </div>

                    <div formGroupName="aliya" class="form-row baseline hdate-row">
                        <label class="form-label small-label">Aliya: (If applicable)</label>
                        <app-hdate (dateChange)="onAliyaDateChange($event)" [day]="aliyaDayValue"
                            [month]="aliyaMonthValue" [engDate]="aliyaEngDateValue">
                        </app-hdate>
                    </div>
                </div>

                <hr>

                <div formGroupName="relative" class="relative-heading-container d-flex align-items-center">
                    <input type="checkbox" [checked]="thereIsSecondAdult()" (change)="toggleRelative()"
                        id="relativeCheckbox">
                    <label for="relativeCheckbox" class="ms-2" style="font-size: 1.5rem;">Add a second adult</label>
                </div>

                @if (thereIsSecondAdult())
                {
                <div formGroupName="relative" class="relative-section text-start">
                    <div class="form-container ">
                        <div class="form-row">
                            <label class="form-label" for="gender">Please select:</label>
                            <select class="form-control" formControlName="gender" id="gender">
                                <option value="MALE">Male</option>
                                <option value="FEMALE">Female</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <label class="form-label" for="firstName">First Name:</label>
                            <input id="firstName" class="form-control" formControlName="firstName"
                                placeholder="First Name">
                        </div>
                        <div class="form-row">
                            <label class="form-label" for="lastName">Last Name:</label>
                            <input id="lastName" class="form-control" formControlName="lastName"
                                placeholder="Last Name">
                        </div>
                        <div class="form-row">
                            <label class="form-label" for="phone">Phone:</label>
                            <input id="phone" class="form-control" formControlName="phone" placeholder="Phone">
                        </div>
                        <div class="form-row">
                            <label class="form-label" for="email">Email:</label>
                            <input id="email" class="form-control" formControlName="email" placeholder="Email">
                        </div>
                    </div>

                    <div class="section form-container ">
                        <!-- Hebrew name and parents -->
                        <div class="form-row">
                            <label class="form-label" for="hebrewName">Hebrew Name:</label>
                            <input id="hebrewName" class="form-control" formControlName="hebrewName"
                                placeholder="Hebrew Name">
                        </div>
                        <div class="form-row">
                            <label class="form-label" for="fatherName">Father's name:</label>
                            <input id="fatherName" class="form-control" formControlName="fatherName"
                                placeholder="Father's Name">
                        </div>
                        <div class="form-row">
                            <label class="form-label" for="motherName">Mother's name:</label>
                            <input id="motherName" class="form-control" formControlName="motherName"
                                placeholder="Mother's Name">
                        </div>
                    </div>

                    <div class="section form-container ">
                        <div formGroupName="dob" class="form-row baseline hdate-row">
                            <label class="form-label small-label">Date of birth:</label>
                            <app-hdate (dateChange)="onDobDateRelativeChange($event)" [day]="dobDayRelValue"
                                [month]="dobMonthRelValue" [engDate]="dobEngDateRelValue">
                            </app-hdate>
                        </div>

                        <div class="form-row baseline hdate-row">
                            @if (memberForm.get('relative.gender')?.value == 'MALE') {
                            <div class="form-row">
                                <label class="form-label small-label" for="bmParasha">Bar Mitzva Parasha:</label>
                                <app-bm-select [selected]="memberForm.get('relative.bmParasha')?.value"
                                    (parashaSelected)="onParashaRelativeSelected($event)"></app-bm-select>
                            </div>
                            }
                        </div>

                        <div formGroupName="anniversary" class="form-row baseline hdate-row">
                            <label class="form-label small-label">Anniversary: (If applicable)</label>
                            <app-hdate (dateChange)="onAnniversaryDateRelativeChange($event)"
                                [day]="anniversaryDayRelValue" [month]="anniversaryMonthRelValue"
                                [engDate]="anniversaryEngDateRelValue">
                            </app-hdate>
                        </div>

                        <div class="form-row">
                            <label class="form-label" for="spouse">Spouse's name:</label>
                            <input id="spouse" class="form-control" formControlName="spouse"
                                placeholder="Spouse's name">
                        </div>

                        <div formGroupName="aliya" class="form-row baseline hdate-row">
                            <label class="form-label small-label">Aliya: (If applicable)</label>
                            <app-hdate (dateChange)="onAliyaDateRelativeChange($event)" [day]="aliyaDayRelValue"
                                [month]="aliyaMonthRelValue" [engDate]="aliyaEngDateRelValue">
                            </app-hdate>
                        </div>
                    </div>
                </div>
                }

                <hr>

                <h4 class="text-center">Yartzeits</h4>
                <table *ngIf="yartzeits.length > 0" class="table text-center">
                    <thead>
                        <tr>
                            <th style="width:fit-content">Name</th>
                            <th>Date</th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let y of yartzeits; let i = index">
                            <td>{{ y.name }}</td>
                            <td>{{ y.date.day }}/{{ y.date.month }}</td>
                            <td>{{ y.relationship | titlecase}}</td>
                            <td> <!--todo: add edit button-->
                                <button (click)="removeYartzeit(y)" class="btn btn-danger btn-delete-ytz">
                                    <i class="bi bi-trash3-fill"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div *ngIf="addingYartzeit" class="text-start">
                    <app-yartzeit (pushYartzeit)="onYartzeitAdded($event)">
                    </app-yartzeit>
                </div>

                <button *ngIf="!addingYartzeit" type="button"
                    class="btn custom-btn d-flex align-items-center text-center" (click)="addYartzeit()">
                    <i class="bi bi-patch-plus me-2" width="20" height="20" fill="green"></i>
                    <span *ngIf="yartzeits.length > 0">Add Another Yartzeit</span>
                    <span *ngIf="yartzeits.length == 0">Add a Yartzeit</span>
                </button>

                <button type="submit" class="btn btn-xl custom-btn d-flex align-items-center text-center">
                    <i class="bi bi-send me-2" width="20" height="20" fill="green"></i>
                    {{isEdit ? 'Click to save changes' : 'Click to save details'}}
                </button>

            </form>
        </div>
    </div>
</div>